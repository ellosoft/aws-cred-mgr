# AWS Credentials Manager CLI

A .NET Core CLI tool that wraps the AWS RDSAuthTokenGenerator for generating an RDS authentication tokens. It allows you to specify connection details via command line arguments or a pre-configured YAML file.

## Coming Soon
Management of AWS credentials

## Prerequisites

- A .NET version that allows the installation of tools
- A configured AWS account

## Installation
```
dotnet install tool -g Ellosoft.AwsCredentialsManager
```

## Usage

There are two ways to use this tool:

1. Directly providing connection details via command line arguments:

    ```sh
    aws-cred-mgr rds -s <server> -u <user_id> -d <database> -p <port> -ssl <ssl_mode> -r <region> -tl <token_lifetime>
    ```

2. Using a pre-configured YAML file:

    1. Modify the `config.yaml` file with your database configurations.
    2. Run the tool and choose the environment and the database interactively:

        ```sh
        aws-cred-mgr rds
        ```

    3. Or specify the environment and database directly:

        ```sh
        aws-cred-mgr rds -e <environment_name> -n <database_name>
        ```

### YAML Configuration

You can specify your database configurations in a YAML file. Here's an example `config.yaml`:

```yml
variables:
    defaultRegion: us-east-1
    defaultSslMode: Required
    defaultTokenLifetime: 15

rds:
    templates:
    - id: template1
        server: template1-endpoint
        userId: template1-user
        port: 5432
    - id: template2
        server: template2-endpoint
        userId: template2-user
        port: 3306

    environments:
    - name: Production
        databases:
        - name: DatabaseA
            templateId: template1
            database: dba-name
            region: ${variables.defaultRegion}
            sslMode: ${variables.defaultSslMode}
            tokenLifetime: ${variables.defaultTokenLifetime}
    - name: Staging
        databases:
        - name: DatabaseB
            templateId: template2
            database: dbb-name
            region: us-west-2
            tokenLifetime: 30
```

In this configuration, `variables` are key-value pairs that are used as default values. `templates` are pre-defined connection configurations. In the `environments` section, each environment can have multiple databases. A database can use a template for its connection details and variables for default values.

## Note

This tool assumes that the AWS CLI is configured with your credentials. The token generated by this tool does not include the password for the database user. After you generate the token, use it as the password in your database connection string.

## Contributing

Please feel free to submit issues, fork the repository and send pull requests!

## License

This project is licensed under the terms of the MIT license.
